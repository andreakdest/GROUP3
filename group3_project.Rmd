---
title: "Group3"
author: "Andrea Dest"
date: "10/5/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

__Load in Lyrics Data__
```{r}
library(tidyverse)
library(data.table)
library(ggplot2)
library(dplyr)
lyrics_swift <- fread("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-29/taylor_swift_lyrics.csv", header =T)

```

Make a Boxplot to show number of words in each Album 
```{r}
lyrics_swift <- mutate(lyrics_swift, total_words = sapply(strsplit(lyrics_swift$Lyrics, " "), length))
total_word_plot <- ggplot(lyrics_swift, aes(x=Album, y=total_words)) + geom_boxplot() + ylab("Total Words") + ggtitle("Total Words by Album")
total_word_plot + geom_point(stat = "summary", fun="mean", color="red", size =2)
```

Make a graph to visualize pronouns used in each album
```{r}
pronouns <- lyrics_swift %>%
  mutate(her=(str_count(Lyrics, "her"))) %>%
  mutate(he=(str_count(Lyrics, "he"))) %>%
  mutate(they=(str_count(Lyrics, "they"))) %>%
  mutate(them=(str_count(Lyrics, "them"))) %>%
  mutate(she=(str_count(Lyrics, "she"))) %>%
  mutate(him=(str_count(Lyrics, "him"))) %>%
  mutate(total_pronouns=her+her+they+them+she+him) %>%
  pivot_longer(her:him, names_to = "pronoun_type", values_to="values")

pronoun_plot <- ggplot(pronouns, aes(x=Album, y= Title, size = total_pronouns)) + geom_point(alpha =0.7) + scale_size(range = c(.1, 3)) + xlab("Album Name") + ylab("Song") + ggtitle("Use of Pronouns by Type") + theme(legend.position="bottom") + theme(axis.text.y=element_blank()) + theme(axis.text.x = element_text(angle=45))

pronoun_plot + facet_wrap(~pronoun_type, ncol =3)
```

